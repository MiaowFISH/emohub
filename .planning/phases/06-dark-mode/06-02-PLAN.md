---
phase: 06-dark-mode
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - apps/web/src/components/ImageToolbar.tsx
  - apps/web/src/components/TagManager.tsx
  - apps/web/src/components/ImageUpload.tsx
  - apps/web/src/components/ImageGrid.tsx
  - apps/web/src/components/BatchTagModal.tsx
  - apps/web/src/components/TagInput.tsx
autonomous: true

must_haves:
  truths:
    - "User can switch between light/dark/system themes from settings"
    - "Theme changes apply instantly to all UI components"
    - "All buttons, modals, status indicators, and overlays render correctly in dark mode"
    - "No hardcoded hex colors remain in component inline styles"
  artifacts:
    - path: "apps/web/src/components/ImageToolbar.tsx"
      provides: "Dark-mode-compatible toolbar with CSS variable colors"
    - path: "apps/web/src/components/TagManager.tsx"
      provides: "Dark-mode-compatible tag manager modal"
    - path: "apps/web/src/components/ImageUpload.tsx"
      provides: "Dark-mode-compatible upload results with status colors"
    - path: "apps/web/src/components/ImageGrid.tsx"
      provides: "Dark-mode-compatible image grid with selection indicators"
    - path: "apps/web/src/components/BatchTagModal.tsx"
      provides: "Dark-mode-compatible batch tag modal"
    - path: "apps/web/src/components/TagInput.tsx"
      provides: "Dark-mode-compatible tag input hover states"
  key_links:
    - from: "all components"
      to: "apps/web/src/styles/theme-variables.css"
      via: "CSS custom properties (var())"
      pattern: "var\\(--color-"
---

<objective>
Convert all hardcoded hex colors in components to CSS variables for full dark mode support.

Purpose: Every UI component must respond to theme changes via CSS variables. Currently 6 components have hardcoded colors that won't change when the theme switches.
Output: All components using CSS variables exclusively — dark mode works across the entire UI.
</objective>

<execution_context>
@/root/.claude/get-shit-done/workflows/execute-plan.md
@/root/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-dark-mode/06-01-SUMMARY.md
@apps/web/src/styles/theme-variables.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert ImageToolbar, TagManager, and ImageUpload to CSS variables</name>
  <files>
    apps/web/src/components/ImageToolbar.tsx
    apps/web/src/components/TagManager.tsx
    apps/web/src/components/ImageUpload.tsx
  </files>
  <action>
Replace all hardcoded hex colors with CSS variable references. Here is the exact mapping for each file:

**ImageToolbar.tsx** — Replace these inline style values:
- `'#10b981'` (Add Tags button bg) → `'var(--color-success)'`
- `'#f59e0b'` (Remove Tags button bg) → `'var(--color-warning)'`
- `'#ef4444'` (Delete button bg, confirm delete button bg) → `'var(--color-danger)'`
- `'#3b82f6'` (Convert to GIF enabled bg) → `'var(--color-info)'`
- `'#e5e7eb'` (Convert to GIF disabled bg) → `'var(--color-disabled-bg)'`
- `'#9ca3af'` (Convert to GIF disabled text) → `'var(--color-disabled-text)'`
- `'rgba(0, 0, 0, 0.5)'` (confirm overlay bg) → `'var(--color-overlay)'`

**TagManager.tsx** — Replace these inline style values:
- `'rgba(0, 0, 0, 0.5)'` (modal overlay bg) → `'var(--color-overlay)'`
- `'0 20px 25px -5px rgba(0, 0, 0, 0.1)'` (modal boxShadow) → `'0 20px 25px -5px var(--color-shadow)'`
- `'#3b82f6'` (Add button bg) → `'var(--color-info)'`
- `'#10b981'` (Save button bg) → `'var(--color-success)'`
- `'#6b7280'` (Cancel edit button bg) → `'var(--color-disabled-text)'`
- `'#fef2f2'` (Delete button bg) → `'var(--color-danger-bg)'`
- `'#ef4444'` (Delete button text, confirm delete button bg) → `'var(--color-danger)'`
- `'rgba(0, 0, 0, 0.6)'` (delete confirm overlay bg) → `'var(--color-overlay-heavy)'`
- `'0 20px 25px -5px rgba(0, 0, 0, 0.1)'` (delete confirm boxShadow) → `'0 20px 25px -5px var(--color-shadow)'`

**ImageUpload.tsx** — Replace these inline style values:
- `'#fef2f2'` (error result bg) → `'var(--color-danger-bg)'`
- `'#fffbeb'` (duplicate result bg) → `'var(--color-warning-bg)'`
- `'#f0fdf4'` (success result bg) → `'var(--color-success-bg)'`
- `'#fecaca'` (error result border) → `'var(--color-danger-border)'`
- `'#fde68a'` (duplicate result border) → `'var(--color-warning-border)'`
- `'#bbf7d0'` (success result border) → `'var(--color-success-border)'`
- `'#ef4444'` (error icon color, error text color) → `'var(--color-danger)'`
- `'#f59e0b'` (warning icon color, duplicate text color) → `'var(--color-warning)'`
- `'#22c55e'` (success icon color) → `'var(--color-success)'`

Do NOT change:
- `'white'` used for button text on colored backgrounds — white text works on both light and dark theme status colors
- Any existing `var(--color-*)` references
- Component logic, props, or structure
  </action>
  <verify>
Run these checks:
- `grep -n '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/ImageToolbar.tsx` returns NO matches
- `grep -n '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/TagManager.tsx` returns NO matches
- `grep -n '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/ImageUpload.tsx` returns NO matches
- `grep -c 'var(--color-' apps/web/src/components/ImageToolbar.tsx` shows increased count
- `npx tsc --noEmit` passes
  </verify>
  <done>ImageToolbar, TagManager, and ImageUpload have zero hardcoded hex colors — all colors reference CSS variables that respond to theme changes.</done>
</task>

<task type="auto">
  <name>Task 2: Convert ImageGrid, BatchTagModal, and TagInput to CSS variables</name>
  <files>
    apps/web/src/components/ImageGrid.tsx
    apps/web/src/components/BatchTagModal.tsx
    apps/web/src/components/TagInput.tsx
  </files>
  <action>
Replace all hardcoded hex colors with CSS variable references:

**ImageGrid.tsx** — Replace these inline style values:
- `'0 4px 6px -1px rgba(0, 0, 0, 0.1)'` (hover boxShadow) → `'0 4px 6px -1px var(--color-shadow)'`
- `'rgba(255, 255, 255, 0.8)'` (unselected checkbox bg) → `'var(--color-surface-float)'`

Do NOT change `'white'` used for the checkmark icon color on the accent background.

**BatchTagModal.tsx** — Replace these inline style values:
- `'rgba(0, 0, 0, 0.5)'` (overlay bg) → `'var(--color-overlay)'`
- `'#10b981'` (Apply button bg in add mode) → `'var(--color-success)'`
- `'#f59e0b'` (Apply button bg in remove mode) → `'var(--color-warning)'`

Also in the `<style>` tag within BatchTagModal:
- `color: #ef4444;` (tag delete button hover) → `color: var(--color-danger);`
- `box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);` (listbox shadow) → `box-shadow: 0 4px 6px -1px var(--color-shadow);`

**TagInput.tsx** — Replace in the `<style>` tag:
- `color: #ef4444;` (tag delete button hover) → `color: var(--color-danger);`
- `box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);` (listbox shadow) → `box-shadow: 0 4px 6px -1px var(--color-shadow);`

Do NOT change:
- `'white'` used for button text on colored backgrounds
- Any existing `var(--color-*)` references
- Component logic, props, or structure
  </action>
  <verify>
Run these checks:
- `grep -n '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/ImageGrid.tsx` returns NO matches
- `grep -n '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/BatchTagModal.tsx` returns NO matches
- `grep -n '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/TagInput.tsx` returns NO matches
- `grep -rn 'rgba(' apps/web/src/components/ImageGrid.tsx apps/web/src/components/BatchTagModal.tsx apps/web/src/components/TagInput.tsx` returns NO matches (all rgba moved to CSS variables)
- `npx tsc --noEmit` passes
- Build succeeds: `cd apps/web && npx vite build --mode development 2>&1 | tail -5`
  </verify>
  <done>ImageGrid, BatchTagModal, and TagInput have zero hardcoded colors — all colors reference CSS variables. The entire UI responds to theme changes.</done>
</task>

</tasks>

<verification>
1. Zero hardcoded hex colors in any component: `grep -rn '#[0-9a-fA-F]\{3,8\}' apps/web/src/components/` returns NO matches
2. Zero hardcoded rgba in component inline styles (only in CSS `<style>` tags via variables): `grep -rn 'rgba(' apps/web/src/components/` returns NO matches
3. TypeScript compiles: `npx tsc --noEmit` passes
4. Build succeeds: `cd apps/web && npx vite build --mode development`
5. All components reference CSS variables: `grep -rc 'var(--color-' apps/web/src/components/` shows counts for all 6 modified files
</verification>

<success_criteria>
- All 6 components use CSS variables exclusively for colors
- No hardcoded hex colors or rgba values remain in component files
- Theme switching from settings page instantly updates all UI elements
- Build passes without errors
- THEME-01 satisfied: light/dark/system switching works across all components
- THEME-02 satisfied: theme persists via settingsStore (Phase 5) + FOUC prevention (Plan 01)
- THEME-03 satisfied: system theme listener in settingsStore (Phase 5) triggers CSS variable swap
</success_criteria>

<output>
After completion, create `.planning/phases/06-dark-mode/06-02-SUMMARY.md`
</output>
