---
phase: 08-enhanced-operations
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/components/SkeletonCard.tsx
  - apps/web/src/components/EmptyState.tsx
  - apps/web/src/styles/skeleton.css
  - apps/web/src/components/ImageGrid.tsx
  - apps/web/src/styles/buttons.css
  - apps/web/src/routes/index.tsx
  - apps/web/src/components/ImageToolbar.tsx
  - apps/web/src/components/TagFilter.tsx
  - apps/web/public/locales/en/images.json
  - apps/web/public/locales/zh/images.json
autonomous: true

must_haves:
  truths:
    - "User sees skeleton placeholder cards with shimmer animation while images load"
    - "User sees a helpful empty state message when no images exist or no search results match"
    - "User can visually distinguish primary actions from secondary actions by button weight"
    - "Skeleton animation respects prefers-reduced-motion setting"
  artifacts:
    - path: "apps/web/src/components/SkeletonCard.tsx"
      provides: "Skeleton placeholder card with shimmer effect"
      exports: ["SkeletonCard"]
    - path: "apps/web/src/components/EmptyState.tsx"
      provides: "Empty state component with icon, title, description"
      exports: ["EmptyState"]
    - path: "apps/web/src/styles/skeleton.css"
      provides: "Skeleton shimmer animation CSS with reduced-motion support"
      contains: "@keyframes shimmer"
    - path: "apps/web/src/styles/buttons.css"
      provides: "Button hierarchy classes: btn-primary, btn-secondary, btn-danger"
      contains: ".btn-primary"
  key_links:
    - from: "apps/web/src/components/ImageGrid.tsx"
      to: "apps/web/src/components/SkeletonCard.tsx"
      via: "import SkeletonCard, render during isLoading"
      pattern: "import.*SkeletonCard"
    - from: "apps/web/src/components/ImageGrid.tsx"
      to: "apps/web/src/components/EmptyState.tsx"
      via: "import EmptyState, render when images.length === 0"
      pattern: "import.*EmptyState"
    - from: "apps/web/src/routes/index.tsx"
      to: "apps/web/src/styles/buttons.css"
      via: "import CSS, apply btn-primary/btn-secondary classes"
      pattern: "import.*buttons"
---

<objective>
Add skeleton loading screens, empty state guidance, and visual button hierarchy to improve perceived performance and UI clarity.

Purpose: Users currently see plain "Loading..." text and "No images" text — skeleton screens improve perceived performance, empty states guide new users, and button hierarchy makes actions clearer.
Output: SkeletonCard component, EmptyState component, button hierarchy CSS, all integrated into existing components.
</objective>

<execution_context>
@/root/.claude/get-shit-done/workflows/execute-plan.md
@/root/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-enhanced-operations/08-RESEARCH.md
@apps/web/src/components/ImageGrid.tsx
@apps/web/src/components/ImageToolbar.tsx
@apps/web/src/components/TagFilter.tsx
@apps/web/src/routes/index.tsx
@apps/web/src/styles/theme-variables.css
@apps/web/src/styles/responsive.css
@apps/web/public/locales/en/images.json
@apps/web/public/locales/zh/images.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SkeletonCard, EmptyState components, and skeleton CSS</name>
  <files>
    apps/web/src/components/SkeletonCard.tsx
    apps/web/src/components/EmptyState.tsx
    apps/web/src/styles/skeleton.css
    apps/web/public/locales/en/images.json
    apps/web/public/locales/zh/images.json
  </files>
  <action>
    1. Create `apps/web/src/styles/skeleton.css`:
       - `.skeleton-card`: `width: 100%`, `aspect-ratio: 1`, `background: var(--color-bg-tertiary)`, `border-radius: 8px`, `overflow: hidden`, `position: relative`
       - `.skeleton-shimmer`: absolute fill, `background: linear-gradient(90deg, transparent, var(--color-surface-float), transparent)`, `animation: shimmer 1.5s ease-in-out infinite`
       - `@keyframes shimmer`: `0% { transform: translateX(-100%); }` to `100% { transform: translateX(100%); }`
       - `@media (prefers-reduced-motion: reduce)`: `.skeleton-shimmer { animation: none; opacity: 0; }` — hides shimmer entirely for reduced motion users

    2. Create `apps/web/src/components/SkeletonCard.tsx`:
       - Import `'@/styles/skeleton.css'`
       - Export `SkeletonCard` component that renders:
         ```
         <div className="skeleton-card" aria-busy="true" role="status">
           <span className="sr-only">{t('grid.loading_image')}</span>
           <div className="skeleton-shimmer" />
         </div>
         ```
       - Use `useTranslation('images')` for the sr-only text

    3. Create `apps/web/src/components/EmptyState.tsx`:
       - Accept prop `type: 'no-images' | 'no-results'`
       - Use `useTranslation('images')` for all text
       - For 'no-images': show a folder/upload icon (SVG, not emoji), title from `t('empty.no_images_title')`, description from `t('empty.no_images_description')`
       - For 'no-results': show a search icon (SVG), title from `t('empty.no_results_title')`, description from `t('empty.no_results_description')`
       - Style: centered flex column, `padding: '48px 24px'`, icon at 48px size in `var(--color-text-muted)`, title in `var(--color-text-primary)` at 18px/600 weight, description in `var(--color-text-muted)` at 14px
       - Use CSS variables for all colors (dark mode compatible)

    4. Add translation keys to EN images.json:
       - `"grid.loading_image": "Loading image..."`
       - `"empty.no_images_title": "No images yet"`
       - `"empty.no_images_description": "Upload some stickers to get started!"`
       - `"empty.no_results_title": "No results found"`
       - `"empty.no_results_description": "Try a different search term or adjust your tag filters."`

    5. Add matching ZH translations to ZH images.json:
       - `"grid.loading_image": "加载图片中..."`
       - `"empty.no_images_title": "还没有图片"`
       - `"empty.no_images_description": "上传一些表情包开始使用吧！"`
       - `"empty.no_results_title": "未找到结果"`
       - `"empty.no_results_description": "试试其他搜索词或调整标签筛选条件。"`

    NOTE: Plan 01 also modifies the images.json locale files (adding clipboard keys). Since both plans are Wave 1, the executor should be aware that these files are shared. The keys being added are in different sections (clipboard.* vs empty.*/grid.*) so there is no conflict — but if running in parallel, the second plan to write should read the file first to preserve the other plan's additions.
  </action>
  <verify>
    - `cd apps/web && bun run build` completes without errors
    - `grep "skeleton-card" apps/web/src/components/SkeletonCard.tsx` confirms component exists
    - `grep "EmptyState" apps/web/src/components/EmptyState.tsx` confirms component exists
    - `grep "@keyframes shimmer" apps/web/src/styles/skeleton.css` confirms animation exists
    - `grep "prefers-reduced-motion" apps/web/src/styles/skeleton.css` confirms a11y support
    - `grep "no_images_title" apps/web/public/locales/en/images.json` confirms translations added
  </verify>
  <done>
    SkeletonCard renders a shimmer-animated placeholder with proper ARIA attributes and reduced-motion support. EmptyState renders contextual guidance for "no images" and "no results" scenarios. All text is translated in both Chinese and English.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate skeleton/empty states into ImageGrid and add button hierarchy CSS</name>
  <files>
    apps/web/src/components/ImageGrid.tsx
    apps/web/src/styles/buttons.css
    apps/web/src/routes/index.tsx
    apps/web/src/components/ImageToolbar.tsx
    apps/web/src/components/TagFilter.tsx
  </files>
  <action>
    1. Create `apps/web/src/styles/buttons.css` with button hierarchy classes:
       - `.btn-primary`: `padding: 8px 16px`, `font-size: 14px`, `font-weight: 600`, `background: var(--color-accent)`, `color: white`, `border: none`, `border-radius: 6px`, `cursor: pointer`, `transition: background 0.15s ease`
       - `.btn-primary:hover`: `background: var(--color-accent-hover)`
       - `.btn-primary:disabled`: `opacity: 0.6`, `cursor: not-allowed`
       - `.btn-secondary`: `padding: 8px 16px`, `font-size: 14px`, `font-weight: 500`, `background: var(--color-bg-primary)`, `color: var(--color-text-primary)`, `border: 1px solid var(--color-border-light)`, `border-radius: 6px`, `cursor: pointer`, `transition: background 0.15s ease`
       - `.btn-secondary:hover`: `background: var(--color-bg-tertiary)`
       - `.btn-danger`: `padding: 8px 16px`, `font-size: 14px`, `font-weight: 600`, `background: var(--color-danger)`, `color: white`, `border: none`, `border-radius: 6px`, `cursor: pointer`
       - `.btn-danger:hover`: `background: var(--color-danger)`, `opacity: 0.9`
       - `.btn-danger:disabled`: `opacity: 0.6`, `cursor: not-allowed`
       - `.btn-success`: same pattern with `var(--color-success)`
       - `.btn-warning`: same pattern with `var(--color-warning)`
       - `.btn-icon`: `padding: 6px`, `background: transparent`, `border: none`, `color: var(--color-text-secondary)`, `cursor: pointer`, `border-radius: 4px`
       - `.btn-icon:hover`: `background: var(--color-bg-tertiary)`, `color: var(--color-text-primary)`

    2. Modify `apps/web/src/components/ImageGrid.tsx`:
       - Import `SkeletonCard` from '@/components/SkeletonCard' and `EmptyState` from '@/components/EmptyState'
       - Replace the loading state block (lines 60-74, the "Loading..." text) with a grid of SkeletonCard components:
         - Render inside a div with the same grid layout as the image grid: `display: 'grid'`, `gridTemplateColumns: repeat(columns, 1fr)`, `gap: '8px'`
         - Show `columns * 3` skeleton cards (3 rows worth) using `Array.from({ length: columns * 3 })`
         - Keep the `parentRef` on the container div for column calculation to work
       - Replace the empty state block (lines 77-91, the "No images yet" text) with:
         - Determine type: if `searchQuery` or `activeTagFilter.length > 0` → `<EmptyState type="no-results" />`, else `<EmptyState type="no-images" />`
         - Need to read `searchQuery` and `activeTagFilter` from `useImageStore` (already destructured at line 14)
       - Also add skeleton cards at the bottom when `isLoading && images.length > 0` (loading more via infinite scroll): render 1 row of `columns` skeleton cards after the virtualizer content

    3. Apply button classes in `apps/web/src/routes/index.tsx`:
       - Import `'@/styles/buttons.css'`
       - Change the "Manage Tags" button from inline styles to `className="btn-secondary"` — remove the redundant inline padding, fontSize, fontWeight, border, borderRadius, cursor styles. Keep only the `whiteSpace: 'nowrap'` and `flexShrink: 0` as inline styles since those are layout-specific.
       - Remove the onMouseEnter/onMouseLeave handlers (CSS :hover handles it now)

    4. Apply button classes in `apps/web/src/components/ImageToolbar.tsx`:
       - Import `'@/styles/buttons.css'`
       - "Select All" button → `className="btn-secondary"`, remove redundant inline styles
       - "Clear" button → `className="btn-secondary"`, remove redundant inline styles
       - "Add Tags" button → `className="btn-success"`, remove redundant inline styles
       - "Remove Tags" button → `className="btn-warning"`, remove redundant inline styles
       - "Delete" button → `className="btn-danger"`, remove redundant inline styles (keep disabled logic)
       - "Convert to GIF" button → `className="btn-primary"`, remove redundant inline styles (keep disabled logic)
       - In the confirm dialog: "Cancel" → `className="btn-secondary"`, "Delete" → `className="btn-danger"`
       - For disabled states, keep the `disabled` attribute — CSS handles the styling via `:disabled` pseudo-class

    5. Apply button class in `apps/web/src/components/TagFilter.tsx`:
       - Import `'@/styles/buttons.css'`
       - Apply `className="btn-secondary"` or appropriate class to any buttons in the tag filter sidebar
       - Only modify button styling, don't change layout or functionality
  </action>
  <verify>
    - `cd apps/web && bun run build` completes without errors
    - `grep "SkeletonCard" apps/web/src/components/ImageGrid.tsx` confirms skeleton integration
    - `grep "EmptyState" apps/web/src/components/ImageGrid.tsx` confirms empty state integration
    - `grep "btn-primary" apps/web/src/styles/buttons.css` confirms button hierarchy CSS exists
    - `grep "btn-secondary" apps/web/src/routes/index.tsx` confirms button classes applied
    - `grep "btn-danger" apps/web/src/components/ImageToolbar.tsx` confirms toolbar buttons updated
  </verify>
  <done>
    ImageGrid shows skeleton cards during loading (with shimmer animation and reduced-motion support) and contextual empty states (no-images vs no-results). Button hierarchy CSS provides consistent primary/secondary/danger visual weight across all components. Inline button styles replaced with CSS classes for maintainability.
  </done>
</task>

</tasks>

<verification>
1. Open the app with empty database — verify skeleton cards appear briefly, then empty state shows "No images yet" with upload guidance
2. Upload images, then search for nonexistent term — verify "No results found" empty state appears with filter adjustment guidance
3. Clear search — images reappear with skeleton cards during load
4. Check button visual hierarchy: "Add Tags" (green/success) and "Delete" (red/danger) should have higher visual weight than "Select All" and "Clear" (secondary/outlined)
5. Open browser DevTools, enable "prefers-reduced-motion: reduce" — verify skeleton shimmer animation stops
6. Test in dark mode — skeleton cards, empty states, and buttons should all use CSS variables correctly
7. Test on mobile viewport — skeleton grid should adapt to column count
8. Switch language — empty state text should translate
</verification>

<success_criteria>
- Skeleton cards with shimmer animation replace "Loading..." text during image fetch
- Empty state with icon and guidance replaces plain "No images" text
- Empty state differentiates between "no images uploaded" and "no search results"
- Skeleton animation respects prefers-reduced-motion
- Buttons across the app have consistent visual hierarchy (primary > secondary > icon)
- All button styles use CSS classes instead of inline styles
- All new text available in both Chinese and English
- Build passes with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-enhanced-operations/08-02-SUMMARY.md`
</output>
